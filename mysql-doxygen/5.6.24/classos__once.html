<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PERFORMANCE SCHEMA: os_once Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PERFORMANCE SCHEMA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classos__once-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">os_once Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="os0once_8h_source.html">os0once.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a76b1ff71a045a72c666cc0654bec1fcb"><td class="memItemLeft" align="right" valign="top">typedef ib_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a></td></tr>
<tr class="separator:a76b1ff71a045a72c666cc0654bec1fcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a8043b83d19ef578c3ea0f5a94632acac"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a8043b83d19ef578c3ea0f5a94632acac">NEVER_DONE</a> = 0</td></tr>
<tr class="separator:a8043b83d19ef578c3ea0f5a94632acac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f38d40cf5a65c11b588487c9d2eee00"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a9f38d40cf5a65c11b588487c9d2eee00">IN_PROGRESS</a> = 1</td></tr>
<tr class="separator:a9f38d40cf5a65c11b588487c9d2eee00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f150cffbcf350f47d698d836d5eea4d"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a8f150cffbcf350f47d698d836d5eea4d">DONE</a> = 2</td></tr>
<tr class="separator:a8f150cffbcf350f47d698d836d5eea4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Execute a given function exactly once in a multi-threaded environment or wait for the function to be executed by another thread.</p>
<p>Example usage: First the user must create a control variable of type <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a> and assign it <a class="el" href="classos__once.html#a8043b83d19ef578c3ea0f5a94632acac">os_once::NEVER_DONE</a>. Then the user must pass this variable, together with a function to be executed to os_once::do_or_wait_for_done().</p>
<p>Multiple threads can call os_once::do_or_wait_for_done() simultaneously with the same (<a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a>) control variable. The provided function will be called exactly once and when os_once::do_or_wait_for_done() returns then this function has completed execution, by this or another thread. In other words os_once::do_or_wait_for_done() will either execute the provided function or will wait for its execution to complete if it is already called by another thread or will do nothing if the function has already completed its execution earlier.</p>
<p>This mimics pthread_once(3), but unfortunatelly pthread_once(3) does not support passing arguments to the init_routine() function. We should use std::call_once() when we start compiling with C++11 enabled. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a76b1ff71a045a72c666cc0654bec1fcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76b1ff71a045a72c666cc0654bec1fcb">&#9670;&nbsp;</a></span>state_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef ib_uint32_t <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Control variables' state type </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8f150cffbcf350f47d698d836d5eea4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f150cffbcf350f47d698d836d5eea4d">&#9670;&nbsp;</a></span>DONE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::DONE = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finished execution. </p>

</div>
</div>
<a id="a9f38d40cf5a65c11b588487c9d2eee00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f38d40cf5a65c11b588487c9d2eee00">&#9670;&nbsp;</a></span>IN_PROGRESS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::IN_PROGRESS = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Currently being executed by this or another thread. </p>

</div>
</div>
<a id="a8043b83d19ef578c3ea0f5a94632acac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8043b83d19ef578c3ea0f5a94632acac">&#9670;&nbsp;</a></span>NEVER_DONE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::NEVER_DONE = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Not yet executed. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>storage/innobase/include/<a class="el" href="os0once_8h_source.html">os0once.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
